{% load static %}
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solo</title>
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"><link href="https://fonts.googleapis.com/css2?family=Lobster&family=Nerko+One&family=Oswald:wght@200..700&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel="stylesheet">
</head>
<body>
    <header>
        <nav>
            <div class="logo-container">
                <h1>Solo</h1> 
            </div>
            <button id="showMessageBtn" >Показать сообщение</button>
            <ul class="nav-links">
                <li><a href="/">Главная</a></li>
                <li><a href="/vital_achievements">Достижения</a></li>
                {% if user.is_authenticated %}
                <li><a href="{% url 'logout' %}">Logout</a></li>
                <li><a href="{% url 'profile' %}">Профиль</a></li>
                {% else %}
                    <li><a href="{% url 'register' %}">Sign up</a></li>
                    <li><a href="{% url 'login' %}">Login</a></li>
                {% endif %}
            </ul>
        </nav>
    </header>
    
{% block content %}{% endblock %}
<footer>
    <ul class="social-icon">
        <li class="social-icon__item">
            <a class="social-icon__link" href="#"><ion-icon name="logo-facebook" role="img" class="md hydrated" aria-label="logo facebook"></ion-icon></a>
        </li>
        <li class="social-icon__item">
            <a class="social-icon__link" href="#"><ion-icon name="logo-twitter" role="img" class="md hydrated" aria-label="logo twitter"></ion-icon></a>
        </li>
        <li class="social-icon__item">
            <a class="social-icon__link" href="#"><ion-icon name="logo-instagram" role="img" class="md hydrated" aria-label="logo instagram"></ion-icon></a>
        </li>
    </ul>
    <p>©2025 Solo | Все права защищены</p>
</footer>
<script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
<audio id="soundAppear" src="{% static 'sounds/soundAppear.mp3' %}"></audio>
<audio id="soundLeveledUp" src="{% static 'sounds/soundLeveledUp.mp3' %}"></audio>
<audio id="soundDisappear" src="{% static 'sounds/soundDisappear.mp3' %}"></audio>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const message = document.getElementById('message');
        const leveledUpText = document.getElementById('leveledUp');
        const soundAppear = document.getElementById('soundAppear');
        const soundLeveledUp = document.getElementById('soundLeveledUp');
        const soundDisappear = document.getElementById('soundDisappear');
        const showMessageBtn = document.getElementById('showMessageBtn');

        let isAudioUnlocked = false;
        let isFirstPlay = true;

        function unlockAudio() {
            if (!isAudioUnlocked) {
                soundAppear.play().then(() => {
                    soundAppear.pause();
                    soundAppear.currentTime = 0;
                    soundLeveledUp.play().then(() => {
                        soundLeveledUp.pause();
                        soundLeveledUp.currentTime = 0;
                    });
                    soundDisappear.play().then(() => {
                        soundDisappear.pause();
                        soundDisappear.currentTime = 0;
                    });
                    isAudioUnlocked = true;
                }).catch(() => {});
            }
            document.removeEventListener('click', unlockAudio);
        }

        function showMessage() {
            message.style.display = 'block';
            message.style.animation = 'showMessage 1s forwards';

            if (isFirstPlay) {
                soundAppear.play();
                isFirstPlay = false;
            } else {
                setTimeout(() => soundAppear.play(), 100);
            }

            const leveledUpDelay = 2000; 
            setTimeout(() => {
                leveledUpText.style.opacity = '1';
                leveledUpText.style.animation = 'leveledUpEffect 1.5s forwards';
                if (isAudioUnlocked) {
                    soundLeveledUp.play();
                }
            }, leveledUpDelay);

        }

        function hideMessage() {
            soundDisappear.play();
            message.style.animation = 'disappearEffect 2s forwards';
            setTimeout(() => {
                message.style.display = 'none';
            }, 2000);
        }

        showMessageBtn.addEventListener('click', showMessage);
        document.addEventListener('click', unlockAudio);
        message.addEventListener('click', hideMessage);
    });
</script>
</body>
</html>